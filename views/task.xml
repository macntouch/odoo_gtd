<openerp><data>

    <menuitem id='task_top_menu' name='Tasks' parent='gtd_top_menu' sequence='10'/>

    <record id='task_all_action' model='ir.actions.act_window'>
        <field name='name'>Project Actions</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
    </record>

    <record id='task_current_action' model='ir.actions.act_window'>
        <field name='name'>Current Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','in',['Next','Today','Tomorrow']),
                              ('project_state','=','Active')]</field>
        <field name='context'>{'default_state': 'Next'}</field>
    </record>
    <menuitem id='task_current_menu' name='Current' parent='task_top_menu'
              sequence='2' action='task_current_action'/>


    <record id='task_today_action' model='ir.actions.act_window'>
        <field name='name'>Today Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','=','Today'),
                              ('project_state','=','Active')]</field>
        <field name='context'>{'default_state': 'Today'}</field>
    </record>

    <menuitem id='task_today_menu' name='Today' parent='task_top_menu'
              sequence='4' action='task_today_action'/>

    <record id='task_tomorrow_action' model='ir.actions.act_window'>
        <field name='name'>Tomorrow Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','=','Tomorrow'),
                              ('project_state','=','Active')]</field>
        <field name='context'>{'default_state': 'Tomorrow'}</field>
    </record>
    <menuitem id='task_tomorrow_menu' name='Tomorrow' parent='task_top_menu'
              sequence='9' action='task_tomorrow_action'/>

    <record id='task_next_action' model='ir.actions.act_window'>
        <field name='name'>Next Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','=','Next')]</field>
        <field name='context'>{'default_state': 'Next'}</field>
    </record>
    <menuitem id='task_next_menu' name='Next' parent='task_top_menu'
              sequence='10' action='task_next_action'/>

    <menuitem id='task_other_menu' name='Other' parent='task_top_menu'
              sequence='11' action='task_next_action'/>

    <menuitem id='task_menu' name='All' parent='task_other_menu'
              sequence='50' action="task_all_action"/>

    <record id='task_waiting_action' model='ir.actions.act_window'>
        <field name='name'>Waiting Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','=','Waiting'),
                              ('project_state','=','Active')]</field>
        <field name='context'>{'default_state': 'Waiting'}</field>
    </record>
    <menuitem id='task_waiting_menu' name='Waiting' parent='task_other_menu'
              sequence='15' action='task_waiting_action'/>

    <record id='task_someday_action' model='ir.actions.act_window'>
        <field name='name'>Someday Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','=','Someday'),
                            ('project_state','=','Active')]</field>
        <field name='context'>{'default_state': 'Someday'}</field>
    </record>
    <menuitem id='task_someday_menu' name='Someday' parent='task_other_menu'
              sequence='15' action='task_someday_action'/>

    <record id='task_done_action' model='ir.actions.act_window'>
        <field name='name'>Done Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','=','Done'),
                            ('project_state','=','Active')]</field>
        <field name='context'>{'default_state': 'Done'}</field>
    </record>
    <menuitem id='task_done_menu' name='Done' parent='task_other_menu'
              sequence='25' action='task_done_action'/>


    <record id='task_scheduled_action' model='ir.actions.act_window'>
        <field name='name'>Scheduled Tasks</field>
        <field name='res_model'>gtd.task</field>
        <field name='view_mode'>tree,form</field>
        <field name='domain'>[('state','=','Scheduled'),
                              ('project_state','=','Active')]</field>
        <field name='context'>{'default_state': 'Scheduled'}</field>
    </record>
    <menuitem id='task_scheduled_menu' name='Scheduled' parent='task_other_menu'
              sequence='20' action='task_scheduled_action'/>

    <record id='task_schedule_action' model='ir.actions.act_window'>
        <field name='name'>Schedule a Task</field>
        <field name='res_model'>gtd.schedule_task</field>
        <field name="target">new</field>
        <field name='view_mode'>form</field>
    </record>

    <record id="task_schedule_form" model="ir.ui.view">
        <field name="name">Task Schedule Form</field>
        <field name="model">gtd.schedule_task</field>
        <field name="arch" type="xml">
            <form string="Schedule a Task">
                <group>
                    <field name="new_start_date"/>
                </group>
                <footer>
                    <button string="Schedule" name="do_schedule" type="object" class="oe_highlight"/>
                    <button special="cancel" string="Cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <record id='task_tree_view' model='ir.ui.view'>
        <field name='name'>GTD Inbox Tree</field>
        <field name='model'>gtd.task</field>
        <field name='arch' type='xml'>
            <tree decoration-danger="state=='Today'"
                  decoration-warning="state=='Tomorrow'"
                  decoration-info="state=='Next'"
                  decoration-muted="state=='Someday'"
                  decoration-bf="state=='Waiting'">

                <field name='sequence' widget='handle'/>
                <field name='name' />
                <button name="set_done" icon="terp-camera_test" type="object"
                        help="Set Done"/>
                <button name="set_today" icon="star-on" type="object"
                        help="Move to Today"/>
                <button name="set_tomorrow" icon="terp-mail-forward" type="object"
                        help="Move to Tomorrow"/>
                <button name="set_next" icon="gtk-connect" type="object"
                        help="Move to Next"/>
                <button name="set_waiting" icon="terp-project" type="object"
                        help="Set Waiting"/>
                <button name="set_someday" icon="gtk-clear" type="object"
                        help="Move to Someday"/>
                <button name="%(task_schedule_action)d" icon="stock_calendar"
                        help="Move to Scheduled" type="action"/>
                <field name='project_area'/>
                <field name="state"/>
                <field name="project"/>
                <field name="state_change_count"/>
            </tree>
        </field>
    </record>

    <record id='task_form_view' model='ir.ui.view'>
        <field name='name'>GTD Inbox Form</field>
        <field name='model'>gtd.task</field>
        <field name='arch' type='xml'>
            <form string='Task'>
                <header>
                    <field name='state_mirror' widget='statusbar' clickable='True'/>
                </header>
                <sheet string='Task'>
                    <div class='oe_title'>
                        <label for='name' class='oe_edit_only'/>
                        <h1><field name='name'/></h1>
                    </div>
                    <group>
                        <group string='Task info'>
                            <field name="note" widget="html" nolabel="1"/>
                        </group>
                        <group string='Task settings'>
                            <field name="state" />
                            <field name="schedule_start_date"
                                   attrs="{'invisible': [('state','!=','Scheduled')]}"/>
                            <field name='project'/>
                            <field name='project_area' invisible="1"/>
                            <field name="state_change_count" readonly="1"/>
                        </group>
                    </group>
                </sheet>
                <!--
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                -->
            </form>
        </field>
    </record>

    <record id="task_search" model="ir.ui.view">
        <field name="name">gtd.task.search</field>
        <field name="model">gtd.task</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="project"/>
                <field name="project_area"/>
                <field name="state"/>
                <field name="project_state"/>
                <group string="Filter by">
                    <filter string="Today" domain="[('state','=','Today')]"/>
                    <filter string="Tomorrow" domain="[('state','=','Tomorrow')]"/>
                    <filter string="Next" domain="[('state','=','Next')]"/>
                    <filter string="Waiting" domain="[('state','=','Waiting')]"/>
                    <filter string="Someday" domain="[('state','=','Someday')]"/>
                    <filter string="Scheduled" domain="[('state','=','Scheduled')]"/>
                </group>
                <group string="Project State">
                    <filter string="Active Projects" domain="[('project_state','=','Active')]"/>
                    <filter string="Onhold Projects" domain="[('project_state','=','Onhold')]"/>
                </group>
                <group string="Group By">
                    <filter string="Task State" name="by_state" domain="[]"
                            context="{'group_by': 'state'}"/>
                    <filter string="Project State" name="by_project_state" domain="[]"
                            context="{'group_by': 'project_state'}"/>
                    <filter string="Area" name="by_area" domain="[]"
                            context="{'group_by': 'project_area'}"/>

                </group>
            </search>
        </field>
    </record>


</data></openerp>